{% extends "base.html" %}
{% block content %}
<h2>Your Cart</h2>

{% if items %}
  <table class="table table-striped align-middle">
    <thead>
      <tr>
        <th>Movie</th>
        <th>Quantity</th>
        <th>Subtotal</th>
        <th style="width: 120px;"></th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.movie.title }}</td>
        <td>{{ item.qty }}</td>
        <td>${{ item.subtotal }}</td>
        <td>
          <form method="post" action="{% url 'remove_from_cart' item.movie.pk %}">
            {% csrf_token %}
            <button class="btn btn-sm btn-outline-danger">Remove</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="d-flex justify-content-between align-items-center">
    <h4 class="mb-0">Total: ${{ total }}</h4>
    <div class="d-flex gap-2">
      <form method="post" action="{% url 'clear_cart' %}">
        {% csrf_token %}
        <button class="btn btn-outline-secondary">Clear Cart</button>
      </form>
      {% if user.is_authenticated %}
        <a href="{% url 'checkout' %}" class="btn btn-success">Checkout</a>
      {% else %}
        <a class="btn btn-primary" href="{% url 'login' %}?next={% url 'view_cart' %}">Log in to Checkout</a>
      {% endif %}
    </div>
  </div>
{% else %}
  <p class="text-muted">Your cart is empty.</p>
{% endif %}
{% endblock %}
